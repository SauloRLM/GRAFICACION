<!DOCTYPE html>
<html>
    <head>
        <title>Trazado de líneas ecuación basica V1</title>
    </head>
    <body style="background-color: aqua;">
         <!--Lienzo para pintar las líneas -->
       <div align="center">
        <h1>Trazado de lineas basados en la ecuacion Basica</h1>
        <h3>Alumno: Lopez Mercado Saulo Ramon 402-Software</h3><br>
        <p>Instruciones de uso:
            1)-cliclea un punto en el lienzo  (primer punto)
            2)-cliclea un segundo punto en el lienzo 
            3)- se formara la linea en base al algoritmo basico
        </p><br>
        <canvas style="border: 3px solid; background-color: white;" id="lienzo" width="300" height="300" onmousedown="dibujar(event)"></canvas> 
        <!--Función dibujar se ejecuta cada que se hace clic sobre el lienzo -->
        <br><br>
        <input type="button" value="LimpiarPizarra" onclick="location.reload()"/>
       </div>


       <!--Script pintar las líneas utilizando javascript -->
       <script stype="text/javascript">
           //para limpiar pizzarra
           function actualizar(){location.reload(true);}
            //-------------------------------------------------------------------------------------

        //xi, yi se usan para guardar las coordenadas del primer punto de la recta
        var xi=0;
        var yi=0;
        //la recta se define por dos puntos, el punto inicial de la recta
        //será la posición donde se haga clic por primera vez y el punto
        //final estaradefinido por la ubicación del segundo clic
        var primerPunto=true; 
        //bandera para controlar los clics
        function PintarPixel(contexto, x,y, color){//Pintar un punto
            contexto.fillStyle = color;
            // Grosor de línea los ultimos dos digitos            
            contexto.fillRect(x, y, 2, 2);
        }
        //Para pintar una recta esta función deberá ser ejecutada dos veces
        //la primera vez captura las coordenadas del punto incial de la recta
        //y lo grafica sobre el lienzo. La segunda vez toma las coordenadas
        //del segundo punto y pinta la línea llamando a la función lineaEcuacionRecta.
        function dibujar(event){
            //Se ejecuta cada que se hace clic sobre el lienzo
            //accedemos al lienzo de dibujo
            var canvas = document.getElementById("lienzo"); 
            //obtenemos el contexto 2d del lienzo
            var contexto = canvas.getContext("2d");         
            
            if(primerPunto){ 
                //Si es el primer clic, se lee el primer punto de la línea
                xi=event.offsetX; //Guardamos la abscisa (x0)
                yi=event.offsetY; //guardamos la ordenada (y0)
                //ponemos el punto inicial en rojo
                PintarPixel(contexto, xi, yi, "blue");                 
                //Para poner la coordenada del punto
                //contexto.fillText( "(" + xi + "," + yi + ")", xi+4, yi);

            }else 
                //Si es el segundo clic, pintamos la línea con los valores xi, yi
                //y la posición del último clic del ratón (event.offsetX, event.offsetY)
                //comparar  el valor del ultimo click para ver si es mayor o menor en el eje de las x                
                //poner coordenada del punto
                //contexto.fillText( "(" + event.offsetX + "," + event.offsetY + ")", event.offsetX+4, event.offsetY);                                
                    PintarPixel(contexto, event.offsetX, event.offsetY, "blue");                                                     
                    CalculosDePuntos(xi, yi, event.offsetX, event.offsetY, contexto, "blue");
                    primerPunto =! primerPunto;//Invertir el valor de la bandera para pintar más líneas                
                
            }
        
        function CalculosDePuntos(x0, y0, x1, y1, contexto, color){

            //delimitar dx y dy para ver atrabes de que se va a calcular si de x o de y
            var dx = Math.abs(x1-x0); //Math.abs() para obtener el valor absoluto
            var dy = Math.abs(y1-y0);                        
            
            var m=(y1-y0)/(x1-x0); //calcular pendiente
            var b= y0 -(m*x0); //determinar el punto donde la recta se cruza con el eje y

            if(dx == 0 ){
                   // revisar el si y0 es menor que y1
                    if(y0<y1){                                            
                        for(var y=y0; y<=y1; y++){ //Elpunto inicial debe estármás a la izq.q el final                                                     
                            PintarPixel(contexto, x1, y, color); //pintar el sig.punto de la línea Math.round() redondeo de y 
                        }
                        //Para poner la coordenada del punto
                        //contexto.fillText( "(" + x1 + "," + y1 + ")", x1+4, y1);
                    }else{
                        //se invierte el eje de y 
                        for(var y=y1; y<=y0; y++){ //Elpunto inicial debe estármás a la izq.q el final                                                     
                            PintarPixel(contexto, x1, y, color); //pintar el sig.punto de la línea Math.round() redondeo de y 
                        }
                        //Para poner la coordenada del punto
                        //contexto.fillText( "(" + x1 + "," + y1 + ")", x1+4, y1);
                    }                
            }        

            //compracion dy y dx para saber en base a que calcular los puntos
            if (dy > dx) {
                //dy es mayor asi que se calcula en base a y                  
                // revisar el si y0 es menor que y1
                if(y0<y1){
                    for(var y=y0; y<=y1; y++){ //Elpunto inicial debe estármás a la izq.q el final                             
                        var x= (y-b)/m; //Ecuación de la recta en base a y
                        PintarPixel(contexto, Math.round(x), y, color); //pintar el sig.punto de la línea Math.round() redondeo de y 
                    }
                    //Para poner la coordenada del punto
                    //contexto.fillText( "(" + x1 + "," + y1 + ")", x1+4, y1);
                }else{
                    //se invierte el eje de y 
                    for(var y=y1; y<=y0; y++){ //Elpunto inicial debe estármás a la izq.q el final                             
                        var x= (y-b)/m; //Ecuación de la recta en base a y
                        PintarPixel(contexto, Math.round(x), y, color); //pintar el sig.punto de la línea Math.round() redondeo de y 
                    }
                    //Para poner la coordenada del punto
                    //contexto.fillText( "(" + x1 + "," + y1 + ")", x1+4, y1);
                }                

            }else{

                if(x1<x0){

                    //dx es mayor asi que se calcula en base a x
                    for(var x=x1; x<=x0; x++){ //Elpunto inicial debe estármás a la izq.q el final
                        var y= (m*x)+b; //Ecuación de la recta en base a x
                        PintarPixel(contexto, x, Math.round(y), color); //pintar el sig.punto de la línea Math.round() redondeo de y 
                    }
                    //Para poner la coordenada del punto
                    //contexto.fillText( "(" + x1 + "," + y1 + ")", x1+4, y1);

                }else{

                    //dx es mayor asi que se calcula en base a x
                    for(var x=x0; x<=x1; x++){ //Elpunto inicial debe estármás a la izq.q el final
                        var y= (m*x)+b; //Ecuación de la recta en base a x
                        PintarPixel(contexto, x, Math.round(y), color); //pintar el sig.punto de la línea Math.round() redondeo de y 
                    }
                    //Para poner la coordenada del punto
                    //contexto.fillText( "(" + x1 + "," + y1 + ")", x1+4, y1);
                }                
            }                                                            
        }

    </script>
   
    </body>
</html>